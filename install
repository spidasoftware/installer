#!/bin/bash
OS=`cat /etc/issue`

#### Ubuntu Section
if [[ $string == *"Ubuntu"* ]]; then
  if [[ $string =~ '\d\.\d']]; then
    VERSION=$BASH_REMATCH
    echo "Ubuntu $VERSION"
    if[[ $VERSION -lt 14.0 ]]; then
      echo "$VERSION is not a supported Ubuntu Version, need > 14.04"
      return -1
    else
      sudo apt-get update
      sudo apt-get install docker.io
      source /etc/bash_completion.d/docker.io
    fi
  fi

#### RHEL Section
elif [[ $string == *"Red Hat Enterprise Linux Server"* ]]; then
  sudo yum update

  # Get the version
  if [[ $string =~ '\d\.\d']]; then
    VERSION=$BASH_REMATCH
    echo "RHEL $VERSION"
    if[[ $VERSION -lt 6.5 ]]; then
      echo "$VERSION is not a supported RHEL Version, need > 6.5"
      return -1
    elif [[ $VERSION -gt 7.0 ]]; then
      sudo subscription-manager repos --enable=rhel-7-server-extras-rpms
      sudo yum install docker
    else
      sudo yum -y remove docker
      sudo yum install docker-io
      sudo yum -y update docker-io
    fi

    #Start the service
    sudo service docker start
    sudo chkconfig docker on

  fi

else
  echo "$string is not a supported OS"
  return -1
fi
